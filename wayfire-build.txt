IMPORTANT: all this is still work in progress - not fully building yet!

based on: http://blog.northfield.ws/wayfire/
     and: https://github.com/DurandA/wayfire/wiki/Ubuntu-20.04-installation

possible fitting display manager: https://git.sr.ht/~kennylevinsen/greetd/

apt-get install git python3-pip pkg-config libwayland-dev autoconf libtool libffi-dev libxml2-dev libegl1-mesa-dev libgles2-mesa-dev libgbm-dev libinput-dev libxkbcommon-dev libpixman-1-dev xutils-dev xcb-proto python3-xcbgen libcairo2-dev libglm-dev libjpeg-dev libgtkmm-3.0-dev xwayland libdrm-dev libgirepository1.0-dev libsystemd-dev policykit-1

# for sound support - optional
apt-get install libasound2-dev pulseaudio

export WF_PREFIX=/opt/wayfire
# one of the next depending on arch
export PKG_CONFIG_PATH=$prefix/lib/pkgconfig:$prefix/share/pkgconfig:$prefix/lib/x86_64-linux-gnu/pkgconfig
export PKG_CONFIG_PATH=$prefix/lib/pkgconfig:$prefix/share/pkgconfig:$prefix/lib/aarch64-linux-gnu/pkgconfig
export PKG_CONFIG_PATH=$prefix/lib/pkgconfig:$prefix/share/pkgconfig:$prefix/lib/arm-linux-gnueabihf/pkgconfig

mkdir /compile/source/wayfire
cd /compile/source/wayfire

git clone https://github.com/mesonbuild/meson.git
ap-get install libx11-xcb-dev libxcb-xinput-dev libxcb-composite0-dev
git clone https://github.com/swaywm/wlroots
git clone https://github.com/WayfireWM/wf-install

cd wlroots
python3 ../meson/meson.py build --prefix=$WF_PREFIX && ninja -C build && ninja -C build install
cd ..

cd wf-install
# replace master with a release tag - e.g. --stream 0.4.0 - to use a particular version
./install.sh --prefix $WF_PREFIX --stream master --clean
cd ..

# create a symlink to use the startwayfire command in the terminal without its full path
ln -s /opt/wayfire/bin/startwayfire /usr/local/bin/startwayfire

# copy config files in place and modify them a bit - not sure if this is still required
cp wayfire/wayfire.ini.default ~/.config/wayfire.ini
cp wf-shell/wf-shell.ini.example ~/.config/wf-shell.ini
sed -i 's/env XDG_CURRENT_DESKTOP=GNOME gnome-control-center/wcm/' ~/.config/wf-shell.ini

# optionally set a background image in ~/.config/wf-shell.ini from your system

# open an application - either run a native terminal ...
WAYLAND_DISPLAY=wayland-0 GDK_BACKEND=wayland terminator

# ... or an x11 one
DISPLAY=:1 xterm

# optionally switch to tty to use the drm backend
# make sure your user is part of the video group to run as user
usermod -G video -a some-user

# optionally create /usr/share/wayland-sessions/wayfire.desktop to login from lightdm
--- snip ---
[Desktop Entry]
Version=1.0
Name=Wayfire Session
Comment=Use this session to run Wayfire as your desktop environment
Exec=/usr/local/bin/wayfire
Type=Application
--- snip ---

# firefox should work as a native browser
# ctrl+alt+bckspc to log out
# to remove the compiled packages and source, remove /opt/wayfire, /compile/source/wayfire, /usr/local/bin/wayfire and /usr/share/wayland-sessions/wayfire.desktop
# checkout wayfire.org for more information.

# troubleshooting - the network widget does not show any connection

ubuntu 20.04 uses netplan which is configured to use networkd
the wayfire network widget only works with networkmanager
make sure that the package network-manager is installed and edit /etc/netplan/01-netcfg.yaml
-> replace networkd with NetworkManager as render:

--- snip ---
network:
  version: 2
  renderer: NetworkManager
--- snip ---
